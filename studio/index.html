<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloxdForge - World Forge | One Stop Solution to Bloxd Gaming</title>
    <meta name="description" content="Bloxd Forge is a Bloxd QOL (Quality-Of-Life) improvement mod that offers texture-packs, a FPS booster, a chat, and a discord for support.">
    <meta name="keywords" content="bloxd, forge, bloxdforge, bloxd forge, bloxd forge plus, chromebook bloxd, bloxd unblocked, minecraft web unblocked, minecraft free, bloxdforge plus, bloxd forge plus, bloxd multiplayer, bloxd bedwars, bloxd skywars, minecraft cracked, minecraft cracked bedwars, minecraft cracked skywars, bloxxd 4v4, bloxd pvp, bloxd autoclicker, bloxd fps booster, bloxd texture packs, bloxd texture pack, bloxd tpack, forge bloxd, forgebloxd, bloxdforge web, bloxd forge web, minecraft browser, minecraft online, minecraft multiplayer browser, minecraft web, minecraft web client, bloxd forge client, bloxd client, bloxd web, bloxd forge web client, minecraft web multiplayer, minecraft browser game, minecraft web game, bloxd forge game, bloxd game, bloxd web game, bloxd forge web game, minecraft unblocked school, minecraft school unblocked, bloxd forge school, bloxd school, minecraft browser unblocked, minecraft online unblocked, bloxd forge unblocked, bloxd unblocked game, minecraft web version, bloxd forge version, bloxd version">
    <link rel="website icon" type="png" href="assets/logo.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Styles for the sign editor popup */
        #sign-editor-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40%;
            height: 60%;
            background-color: white;
            z-index: 9999;
            border: 2px solid #444;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            cursor: move;
            resize: both;
            overflow: hidden;
        }
        #sign-editor-popup iframe {
            width: 100%;
            height: calc(100% - 40px);
            border: none;
        }
        #sign-editor-popup button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #444;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="top-bar">
        <img src="assets/logo.png" width="50" height="50">
        <h2>World Forge</h2>
    </div>

    <div id="main-container">
        <div id="left-sidebar">
            <div id="storage-area" onclick="document.getElementById('file-input').click();">
                <i class="ri-file-3-line" style="font-size: 30px;"></i>
                <p>Add Files</p>
                <input type="file" id="file-input" style="display: none;" onchange="handleFileUpload(event)">
            </div>

            <div class="file-card" onclick="downloadFile('house.bloxdschem')"></div>

            <div id="write-text-area" onclick="openTextEditor()">
                <i class="ri-edit-2-line" style="font-size: 30px;"></i>
                <p>Write Text</p>
            </div>

            <div id="saved-texts"></div>
        </div>

        <div id="iframe-container">
            <iframe id="game-frame" src="https://bloxd.io" scrolling="no"></iframe>
        </div>

        <div id="text-popup" class="popup">
            <div class="popup-content">
                <input type="text" id="text-title" placeholder="Enter Title">
                <textarea id="text-body" placeholder="Write your text here..."></textarea>
                <button onclick="saveText()">Save</button>
                <button onclick="closeTextPopup()">Close</button>
            </div>
        </div>

        <div id="view-popup" class="popup">
            <div class="popup-content">
                <h3 id="view-title"></h3>
                <p id="view-body"></p>
                <button onclick="closeViewPopup()">Close</button>
            </div>
        </div>

        <div id="right-sidebar">
            <button id="world-edit-btn" class="Right-Buttons" onclick="toggleWEmenu()">World Edit<i class="ri-arrow-left-s-line" style="font-size: 20px;"></i></button>
            <div id="World-edit-box">
                <button class="command-button" onclick="copyToClipboard('//pos1')">Pos 1 <i class="ri-flag-fill"></i></button>
                <button class="command-button" onclick="copyToClipboard('//pos2')">Pos 2 <i class="ri-flag-fill"></i></button>
                <button class="command-button" onclick="copyToClipboard('//copy')">Copy <i class="ri-file-copy-fill"></i></button>
                <button class="command-button" onclick="copyToClipboard('//paste')">Paste <i class="ri-clipboard-fill"></i></button>
                <button class="command-button" onclick="copyToClipboard('//schematic load')">Load <i class="ri-download-cloud-fill"></i></button>
                <button class="command-button" onclick="copyToClipboard('//schematic save')">Save <i class="ri-save-fill"></i></button>
            </div>
            <button class="Right-Buttons" id="first-child" onclick="createSign()">
                Create Sign <i class="ri-signpost-fill" style="margin-left: 8px;"></i>
            </button>
            <button class="Right-Buttons" onclick="placeholderAction()">Placeholder <i class="ri-add-box-line" style="margin-left: 8px;"></i></button>
        </div>
    </div>

    <!-- Hidden sign editor popup -->
    <div id="sign-editor-popup">
        <div class="container">
            <div class="form-group">
                <label for="sign-type">Select Sign Type:</label>
                <select id="sign-type" onchange="toggleCostFields()">
                    <option value="" disabled selected>Please choose</option>
                    <option value="buy">Press to Buy</option>
                    <option value="get">Press to Get</option>
                </select>
            </div>
            <div class="form-group input-container">
                <label for="item-name">Search for Item:</label>
                <input type="text" id="item-name" placeholder="Type item name...">
                <ul id="suggestions"></ul>
            </div>
            <div class="form-group">
                <label for="item-amount">Enter Amount:</label>
                <input type="number" id="item-amount" placeholder="Amount" min="1">
            </div>
            <div id="cost-fields" style="display: none;">
                <div class="form-group">
                    <label for="item-cost">Enter Cost Amount:</label>
                    <input type="number" id="item-cost" placeholder="Cost Amount" min="1">
                </div>
                <div class="form-group">
                    <label for="item-cost-type">Enter Cost Item:</label>
                    <input type="text" id="item-cost-type" placeholder="Cost Item Name">
                </div>
            </div>
            <button onclick="generateSign()">Generate Sign</button>
            <h3>Generated Sign:</h3>
            <textarea id="generated-sign" readonly></textarea>
        </div>
        <button onclick="document.getElementById('sign-editor-popup').style.display = 'none'">Close</button>
    </div>

    <script>
        // JavaScript code from script.js and sign.html
        let writeTextArea = document.getElementById("write-text-area");
        writeTextArea.onclick = openTextEditor;

        function openTextEditor() {
            let textEditor = document.createElement("div");
            textEditor.id = "text-editor";
            textEditor.style.position = "fixed";
            textEditor.style.top = "50%";
            textEditor.style.left = "50%";
            textEditor.style.transform = "translate(-50%, -50%)";
            textEditor.style.width = "500px";
            textEditor.style.background = "#282828";
            textEditor.style.padding = "10px";
            textEditor.style.zIndex = "1000";
            textEditor.style.border = "2px solid #444";
            textEditor.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.3)";

            let titleInput = document.createElement("input");
            titleInput.type = "text";
            titleInput.placeholder = "Enter title";
            titleInput.style.width = "100%";
            titleInput.style.marginBottom = "10px";
            titleInput.style.background = "#383838";
            titleInput.style.border = "1px solid #484848";
            titleInput.style.padding = "8px";
            titleInput.style.borderRadius = "4px";

            let textInput = document.createElement("textarea");
            textInput.placeholder = "Write your text here...";
            textInput.style.width = "100%";
            textInput.style.minHeight = "300px";
            textInput.style.marginBottom = "10px";
            textInput.style.background = "#383838";
            textInput.style.border = "1px solid #484848";
            textInput.style.padding = "8px";
            textInput.style.borderRadius = "4px";
            textInput.style.resize = "vertical";

            let saveButton = document.createElement("button");
            saveButton.innerText = "Save";
            saveButton.style.width = "100%";
            saveButton.style.background = "#383838";
            saveButton.style.border = "none";
            saveButton.style.padding = "10px 20px";
            saveButton.style.cursor = "pointer";
            saveButton.style.borderRadius = "8px";
            saveButton.style.color = "white";
            saveButton.style.fontSize = "14px";
            saveButton.onclick = () => saveText(titleInput.value, textInput.value, textEditor);

            let closeButton = document.createElement("button");
            closeButton.innerText = "Close";
            closeButton.style.width = "100%";
            closeButton.style.marginTop = "10px";
            closeButton.style.background = "#383838";
            closeButton.style.border = "none";
            closeButton.style.padding = "10px 20px";
            closeButton.style.cursor = "pointer";
            closeButton.style.borderRadius = "8px";
            closeButton.style.color = "white";
            closeButton.style.fontSize = "14px";
            closeButton.onclick = () => textEditor.remove();

            textEditor.appendChild(titleInput);
            textEditor.appendChild(textInput);
            textEditor.appendChild(saveButton);
            textEditor.appendChild(closeButton);
            document.body.appendChild(textEditor);
        }

        function saveText(title, text, editor) {
            if (!title || !text) return;
            let texts = JSON.parse(localStorage.getItem("savedTexts")) || [];
            texts.push({ title, text });
            localStorage.setItem("savedTexts", JSON.stringify(texts));
            displaySavedTexts();
            editor.remove();
        }

        function displaySavedTexts() {
            let writeTextArea = document.getElementById("write-text-area");

            const existingTextCards = writeTextArea.querySelectorAll(".file-card-wrapper");
            existingTextCards.forEach(card => card.remove());

            let texts = JSON.parse(localStorage.getItem("savedTexts")) || [];
            texts.forEach((item, index) => {
                const fileCardWrapper = document.createElement("div");
                fileCardWrapper.classList.add("file-card-wrapper");
                const fileCard = document.createElement("div");
                fileCard.classList.add("file-card");

                const displayTextTitle = item.title.length > 10 ? item.title.substring(0, 10) + "..." : item.title;
                fileCard.textContent = displayTextTitle;
                fileCard.onclick = (event) => {
                    event.stopPropagation();
                    openSavedText(item);
                };

                const removeBtn = document.createElement("button");
                removeBtn.classList.add("remove-btn");

                const removeIcon = document.createElement("i");
                removeIcon.classList.add("ri-delete-bin-line");

                removeBtn.textContent = "Remove ";
                removeBtn.appendChild(removeIcon);
                removeBtn.onclick = (event) => {
                    event.stopPropagation();
                    removeSavedText(index);
                };

                fileCardWrapper.appendChild(fileCard);
                fileCardWrapper.appendChild(removeBtn);

                writeTextArea.appendChild(fileCardWrapper);
            });
        }

        function openSavedText(item) {
            let textPopup = document.createElement("div");
            textPopup.style.position = "fixed";
            textPopup.style.top = "50%";
            textPopup.style.left = "50%";
            textPopup.style.transform = "translate(-50%, -50%)";
            textPopup.style.width = "500px";
            textPopup.style.height = "400px";
            textPopup.style.background = "#282828";
            textPopup.style.padding = "10px";
            textPopup.style.zIndex = "1000";
            textPopup.style.border = "2px solid #444";
            textPopup.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.3)";
            textPopup.style.display = "flex";
            textPopup.style.flexDirection = "column";

            let title = document.createElement("h3");
            title.innerText = item.title;

            let content = document.createElement("p");
            content.innerText = item.text;
            content.style.flexGrow = "1";

            let closeBtn = document.createElement("button");
            closeBtn.innerText = "Close";
            closeBtn.style.width = "100%";
            closeBtn.style.background = "#383838";
            closeBtn.style.border = "none";
            closeBtn.style.padding = "10px 20px";
            closeBtn.style.cursor = "pointer";
            closeBtn.style.borderRadius = "8px";
            closeBtn.style.color = "white";
            closeBtn.style.fontSize = "14px";
            closeBtn.onclick = () => textPopup.remove();

            textPopup.appendChild(title);
            textPopup.appendChild(content);
            textPopup.appendChild(closeBtn);
            document.body.appendChild(textPopup);
        }

        function removeSavedText(index) {
            let texts = JSON.parse(localStorage.getItem("savedTexts")) || [];
            texts.splice(index, 1);
            localStorage.setItem("savedTexts", JSON.stringify(texts));
            displaySavedTexts();
        }

        displaySavedTexts();

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const fileName = file.name;
                const fileURL = URL.createObjectURL(file);
                addFileCard(fileName, fileURL);
                saveFileToLocalStorage(fileName, fileURL);
            }
        }

        function addFileCard(fileName, fileURL) {
            let filediv = document.querySelector("#storage-area");

            const displayFileName = fileName.length > 13 ? fileName.substring(0, 13) + "..." : fileName;
            const fileCard = document.createElement("div");
            fileCard.classList.add("file-card");
            fileCard.textContent = displayFileName;
            fileCard.onclick = () => downloadFile(fileURL);

            const removeBtn = document.createElement("button");
            removeBtn.classList.add("remove-btn");

            const removeIcon = document.createElement("i");
            removeIcon.classList.add("ri-delete-bin-line");

            removeBtn.textContent = "Remove ";
            removeBtn.appendChild(removeIcon);
            removeBtn.onclick = (event) => confirmRemove(event, fileName, fileCardWrapper);

            const fileCardWrapper = document.createElement("div");
            fileCardWrapper.classList.add("file-card-wrapper");
            fileCardWrapper.appendChild(fileCard);
            fileCardWrapper.appendChild(removeBtn);

            filediv.appendChild(fileCardWrapper);
        }

        function confirmRemove(event, fileName, fileCardWrapper) {
            event.stopPropagation();

            const confirmation = confirm(`Are you sure you want to remove ${fileName}?`);
            if (confirmation) {
                removeFileFromLocalStorage(fileName);
                fileCardWrapper.remove();
            }
        }

        function saveFileToLocalStorage(fileName, fileURL) {
            const files = JSON.parse(localStorage.getItem("uploadedFiles")) || [];
            files.push({ fileName, fileURL });
            localStorage.setItem("uploadedFiles", JSON.stringify(files));
        }

        function removeFileFromLocalStorage(fileName) {
            const files = JSON.parse(localStorage.getItem("uploadedFiles")) || [];
            const updatedFiles = files.filter(file => file.fileName !== fileName);
            localStorage.setItem("uploadedFiles", JSON.stringify(updatedFiles));
        }

        function loadSavedFiles() {
            const files = JSON.parse(localStorage.getItem("uploadedFiles")) || [];
            files.forEach(file => addFileCard(file.fileName, file.fileURL));
        }

        function downloadFile(file) {
            const a = document.createElement("a");
            a.href = file;
            a.download = file;
            a.click();
        }

        window.onload = loadSavedFiles;

        function copyToClipboard(command) {
            navigator.clipboard.writeText(command).then(() => {
            }).catch((error) => {
                console.error("Error copying text: ", error);
            });
        }

        function createSign() {
            document.getElementById("sign-editor-popup").style.display = "block";
        }

        function toggleWEmenu() {
            let WEicon = document.querySelector("#world-edit-btn i");
            let WEMENU = document.getElementById("World-edit-box");
            let WEbutton = document.getElementById("world-edit-btn");

            if (WEicon.classList.contains("ri-arrow-left-s-line")) {
                WEicon.classList.remove("ri-arrow-left-s-line");
                WEicon.classList.add("ri-arrow-down-s-line");

                WEbutton.style.borderRadius = "10px 10px 0 0";
                WEMENU.style.display = "flex";
            } else {
                WEicon.classList.remove("ri-arrow-down-s-line");
                WEicon.classList.add("ri-arrow-left-s-line");

                WEbutton.style.borderRadius = "10px";
                WEMENU.style.display = "none";
            }
        }

        // Sign editor functionality
        let items = [];

        fetch("/items.txt")
            .then(response => response.text())
            .then(data => {
                items = data.split("\n").map(item => item.trim()).filter(item => item.length > 0);
            })
            .catch(err => {
                console.error("Error fetching items:", err);
                alert("Failed to load item list.");
            });

        function toggleCostFields() {
            const signType = document.getElementById("sign-type").value;
            const costFields = document.getElementById("cost-fields");

            if (signType === "buy") {
                costFields.style.display = "block";
            } else {
                costFields.style.display = "none";
            }
        }

        function generateSign() {
            const signType = document.getElementById("sign-type").value;
            const itemName = document.getElementById("item-name").value;
            const itemAmount = document.getElementById("item-amount").value;

            if (!items.includes(itemName)) {
                alert("Item not found. Please check the name.");
                return;
            }

            if (itemAmount <= 0 || isNaN(itemAmount)) {
                alert("Please enter a valid amount.");
                return;
            }

            let signText = "";

            if (signType === "buy") {
                const itemCost = document.getElementById("item-cost").value;
                const itemCostType = document.getElementById("item-cost-type").value;

                if (itemCost <= 0 || isNaN(itemCost)) {
                    alert("Please enter a valid cost.");
                    return;
                }
                if (!items.includes(itemCostType)) {
                    alert("Cost item not found. Please check the name.");
                    return;
                }

                signText = `Press to Buy\n${itemAmount} ${itemName}\ncosts\n${itemCost} ${itemCostType}`;
            } else if (signType === "get") {
                signText = `Press to Get\n${itemAmount} ${itemName}`;
            }

            document.getElementById("generated-sign").value = signText;
        }

        document.getElementById("item-name").addEventListener("input", function () {
            const searchQuery = this.value.toLowerCase();
            const suggestions = items.filter(item => item.toLowerCase().includes(searchQuery));
            const suggestionsList = document.getElementById("suggestions");

            if (searchQuery === "") {
                suggestionsList.innerHTML = '';
                return;
            }

            suggestionsList.innerHTML = '';

            suggestions.forEach(item => {
                const listItem = document.createElement("li");
                listItem.textContent = item;
                listItem.onclick = () => {
                    document.getElementById("item-name").value = item;
                    suggestionsList.innerHTML = '';
                };
                suggestionsList.appendChild(listItem);
            });
        });
    </script>
</body>
</html>